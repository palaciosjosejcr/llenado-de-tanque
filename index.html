import tkinter as tk
import serial

# Cambia el COM seg√∫n tu PC
arduino = serial.Serial('COM3', 9600)

nivel = 100  # nivel del tanque

root = tk.Tk()
root.title("Simulador Tanque")

canvas = tk.Canvas(root, width=400, height=300)
canvas.pack()

# Luces piloto
luz_vaciado = canvas.create_oval(50, 50, 90, 90, fill="gray")
luz_llenado = canvas.create_oval(50, 110, 90, 150, fill="gray")

canvas.create_text(140, 70, text="VACIADO")
canvas.create_text(140, 130, text="LLENADO")

# Tanque
tanque = canvas.create_rectangle(250, 50, 330, 250, outline="black")
nivel_agua = canvas.create_rectangle(250, 250, 330, 250, fill="blue")

def actualizar():
    global nivel

    if arduino.in_waiting:
        estado = arduino.readline().decode().strip()

        if estado == "VACIANDO":
            canvas.itemconfig(luz_vaciado, fill="green")
            canvas.itemconfig(luz_llenado, fill="gray")
            nivel = max(0, nivel - 5)

        if estado == "LLENO":
            canvas.itemconfig(luz_vaciado, fill="gray")
            canvas.itemconfig(luz_llenado, fill="green")
            nivel = 100

        canvas.coords(
            nivel_agua,
            250,
            250 - (nivel * 2),
            330,
            250
        )

    root.after(500, actualizar)

actualizar()
root.mainloop()
